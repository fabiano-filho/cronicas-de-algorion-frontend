<!doctype html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Cr√¥nicas de Algorion ‚Äî Painel do Mestre</title>
        <meta
            name="description"
            content="Painel do Mestre de Cr√¥nicas de Algorion: controle de rodada, eventos e enigmas."
        />
        <meta name="theme-color" content="#0f1115" />
        <link rel="stylesheet" href="../css/mestre.css" />
        <link rel="stylesheet" href="../css/ui-feedback.css" />
    </head>

    <body>
        <noscript>
            Para jogar Cr√¥nicas de Algorion, ative o JavaScript no seu
            navegador.
        </noscript>
        <!-- Header -->
        <header class="mestre-header">
            <div class="header-left">
                <span class="mestre-badge">üëë MESTRE</span>
                <div class="session-info">
                    <span class="session-code" id="sessionCode">------</span>
                    <span
                        class="session-status"
                        id="sessionStatus"
                        aria-live="polite"
                        >Conectando...</span
                    >
                </div>
            </div>
            <div class="header-right">
                <button
                    class="btn-header btn-encerrar"
                    id="btnSairSessao"
                    type="button"
                >
                    üö™ Sair
                </button>
            </div>
        </header>

        <!-- Main Container -->
        <div class="mestre-container" id="main">
            <!-- Left Sidebar - Players -->
            <aside class="sidebar-players">
                <h2 class="sidebar-title"><span>üë•</span> Jogadores</h2>
                <div class="players-list" id="playersList">
                    <!-- Players will be rendered here -->
                    <div class="player-card">
                        <div class="player-header">
                            <span class="player-name">Aguardando...</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Game Status Bar -->
                <div class="game-status-bar">
                    <div class="status-item">
                        <div class="status-label">Rodada</div>
                        <div class="status-value" id="rodadaAtual">1</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Turno</div>
                        <div class="status-value" id="turnoAtual">1</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Jogador da Vez</div>
                        <div
                            class="status-value current-player"
                            id="jogadorDaVez"
                        >
                            -
                        </div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Eventos Restantes</div>
                        <div class="status-value" id="eventosRestantes">-</div>
                    </div>
                    <div class="status-item status-item-ph">
                        <div class="status-label">Pontos de Hist√≥ria</div>
                        <div class="status-value ph-display" id="phGlobal">
                            <span id="phValor">-</span>
                            <button
                                class="btn-edit-ph"
                                id="btnEditPh"
                                type="button"
                                aria-label="Editar PH"
                                title="Editar Pontos de Hist√≥ria"
                            >
                                &#x270F;&#xFE0F;
                            </button>
                        </div>
                        <div class="ph-edit-inline hidden" id="phEditInline">
                            <button
                                class="ph-btn"
                                id="btnPhMinus"
                                type="button"
                                aria-label="Diminuir PH"
                            >
                                ‚àí
                            </button>
                            <input
                                type="number"
                                id="inputPhValue"
                                class="ph-input"
                                min="0"
                                max="999"
                                step="1"
                                aria-label="Valor de PH"
                            />
                            <button
                                class="ph-btn"
                                id="btnPhPlus"
                                type="button"
                                aria-label="Aumentar PH"
                            >
                                +
                            </button>
                            <button
                                class="ph-btn ph-btn-save"
                                id="btnPhSave"
                                type="button"
                            >
                                Salvar
                            </button>
                            <button
                                class="ph-btn ph-btn-cancel"
                                id="btnPhCancel"
                                type="button"
                            >
                                ‚úï
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Board Preview -->
                <section class="board-section">
                    <div class="section-header">
                        <h2 class="section-title">üéÆ Tabuleiro</h2>
                    </div>
                    <div class="board-preview">
                        <div
                            class="board-grid mestre-board-grid"
                            aria-label="Tabuleiro 3x3"
                        >
                            <div
                                class="house-card"
                                data-house-id="1"
                                data-house-name="Biblioteca"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/1-front.png"
                                            alt="Casa 1 - Biblioteca"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/1-back.png"
                                            alt="Casa 1 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div
                                class="house-card"
                                data-house-id="2"
                                data-house-name="Masmorra"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/2-front.png"
                                            alt="Casa 2 - Masmorra"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/2-back.png"
                                            alt="Casa 2 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div
                                class="house-card"
                                data-house-id="3"
                                data-house-name="Jardim"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/3-front.png"
                                            alt="Casa 3 - Jardim"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/3-back.png"
                                            alt="Casa 3 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div
                                class="house-card"
                                data-house-id="4"
                                data-house-name="Mercado"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/4-front.png"
                                            alt="Casa 4 - Mercado"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/4-back.png"
                                            alt="Casa 4 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div
                                class="house-card"
                                data-house-id="5"
                                data-house-name="Bosque"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/5-front.png"
                                            alt="Casa 5 - Bosque"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/5-back.png"
                                            alt="Casa 5 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div
                                class="house-card"
                                data-house-id="6"
                                data-house-name="Arena"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/6-front.png"
                                            alt="Casa 6 - Arena"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/6-back.png"
                                            alt="Casa 6 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div
                                class="house-card"
                                data-house-id="7"
                                data-house-name="Deserto"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/7-front.png"
                                            alt="Casa 7 - Deserto"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/7-back.png"
                                            alt="Casa 7 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div
                                class="house-card"
                                data-house-id="8"
                                data-house-name="Castelo"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/8-front.png"
                                            alt="Casa 8 - Castelo"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/8-back.png"
                                            alt="Casa 8 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>

                            <div
                                class="house-card"
                                data-house-id="9"
                                data-house-name="Montanha"
                            >
                                <div class="house-card-inner">
                                    <div class="house-card-front">
                                        <img
                                            src="../assets/cards/houses/9-front.png"
                                            alt="Casa 9 - Montanha"
                                        />
                                    </div>
                                    <div class="house-card-back">
                                        <img
                                            src="../assets/cards/houses/9-back.png"
                                            alt="Casa 9 - Verso"
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Action Log -->
                <section class="panel log-panel">
                    <h3 class="panel-title">üìã Log de A√ß√µes</h3>
                    <div class="log-entries" id="logEntries">
                        <div class="log-entry info">
                            <span class="log-time">--:--</span>
                            <span class="log-message"
                                >Aguardando in√≠cio do jogo...</span
                            >
                        </div>
                    </div>
                </section>
            </main>

            <!-- Right Sidebar - Controls -->
            <aside class="sidebar-controls" id="sidebarControls">
                <!-- Event Card Panel -->
                <div class="panel">
                    <h3 class="panel-title">üé¥ Evento da Rodada</h3>
                    <div class="event-card-display" id="eventCardDisplay">
                        <span class="no-event">Nenhum evento ativo</span>
                    </div>
                </div>

                <!-- Current Riddle Panel -->
                <div class="panel">
                    <h3 class="panel-title">‚ùì Charada Atual</h3>
                    <div class="riddle-display" id="riddleDisplay">
                        <p class="no-riddle">Nenhuma charada em andamento</p>
                    </div>
                    <div
                        class="validation-buttons"
                        id="validationButtons"
                        style="display: none"
                    >
                        <button
                            class="btn-control btn-primary"
                            id="btnAcertou"
                            type="button"
                        >
                            ‚úÖ Acertou
                        </button>
                        <button
                            class="btn-control btn-danger"
                            id="btnErrou"
                            type="button"
                        >
                            ‚ùå Errou
                        </button>
                    </div>
                </div>

                <!-- Final Challenge Panel -->
                <div class="panel">
                    <h3 class="panel-title">üèÅ Desafio Final</h3>
                    <div class="riddle-display" id="finalChallengeDisplay">
                        <p class="no-riddle">Ainda n√£o iniciado</p>
                    </div>
                    <div
                        class="validation-buttons"
                        id="finalChallengeButtons"
                        style="display: none"
                    >
                        <button
                            class="btn-control btn-primary"
                            id="btnFinalAcertou"
                            type="button"
                        >
                            ‚úÖ Acertou
                        </button>
                        <button
                            class="btn-control btn-danger"
                            id="btnFinalErrou"
                            type="button"
                        >
                            ‚ùå Errou
                        </button>
                    </div>
                </div>

                <!-- Game Control Panel -->
                <div class="panel">
                    <h3 class="panel-title">‚öôÔ∏è Controles do Jogo</h3>
                    <div class="control-buttons">
                        <button
                            class="btn-control btn-warning"
                            id="btnProximoTurno"
                            type="button"
                        >
                            ‚è≠Ô∏è Pr√≥ximo Turno
                        </button>
                    </div>
                </div>

                <!-- Timer Panel -->
                <div class="panel timer-panel">
                    <h3 class="panel-title">‚è±Ô∏è Cron√¥metro</h3>
                    <div class="timer-display" id="timerDisplay">01:00</div>
                    <div class="timer-presets">
                        <button
                            class="btn-timer-preset"
                            data-time="30"
                            type="button"
                        >
                            30s
                        </button>
                        <button
                            class="btn-timer-preset active"
                            data-time="60"
                            type="button"
                        >
                            1min
                        </button>
                        <button
                            class="btn-timer-preset"
                            data-time="120"
                            type="button"
                        >
                            2min
                        </button>
                        <button
                            class="btn-timer-preset"
                            data-time="180"
                            type="button"
                        >
                            3min
                        </button>
                    </div>
                    <div class="timer-controls">
                        <button
                            class="btn-control btn-primary"
                            id="btnIniciarTimer"
                            type="button"
                        >
                            ‚ñ∂Ô∏è Iniciar
                        </button>
                        <button
                            class="btn-control btn-warning"
                            id="btnPausarTimer"
                            type="button"
                            disabled
                        >
                            ‚è∏Ô∏è Pausar
                        </button>
                        <button
                            class="btn-control btn-secondary"
                            id="btnResetTimer"
                            type="button"
                        >
                            üîÑ Reset
                        </button>
                    </div>
                </div>

                <!-- Quick Actions Panel -->
                <div class="panel">
                    <h3 class="panel-title">‚ö° A√ß√µes R√°pidas</h3>
                    <div class="control-buttons">
                        <button
                            class="btn-control btn-secondary"
                            id="btnVerCartas"
                            type="button"
                        >
                            üÉè Ver Todas as Dicas
                        </button>
                        <button
                            class="btn-control btn-secondary"
                            id="btnVirarC5"
                            type="button"
                        >
                            üü© Virar Carta C5
                        </button>
                        <button
                            class="btn-control btn-danger"
                            id="btnReiniciarSessao"
                            type="button"
                        >
                            üîÑ Reiniciar Sess√£o
                        </button>
                    </div>
                    <div class="panel" style="margin-top: 12px">
                        <h3 class="panel-title">üß© Exibir Desafio</h3>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap">
                            <select
                                id="mestreCasaSelect"
                                class="btn-control btn-secondary"
                                style="flex: 1; min-width: 140px"
                            >
                                <option value="">Carregando casas...</option>
                            </select>
                            <button
                                class="btn-control btn-primary"
                                id="btnExibirEnigma"
                                type="button"
                            >
                                üì® Exibir
                            </button>
                        </div>
                        <div
                            id="mestreExibirHint"
                            class="panel-hint"
                            style="margin-top: 6px"
                        ></div>
                    </div>

                    <!-- Painel de teste (somente quando ?debug=1) -->
                    <div
                        class="panel"
                        id="debugPanel"
                        style="display: none; margin-top: 12px"
                    >
                        <h3 class="panel-title">üß™ Teste: Simular Enigma</h3>
                        <div style="display: flex; gap: 8px; flex-wrap: wrap">
                            <select
                                id="debugCasaSelect"
                                class="btn-control btn-secondary"
                                style="flex: 1; min-width: 140px"
                            >
                                <option value="">Carregando casas...</option>
                            </select>
                            <input
                                id="debugTexto"
                                type="text"
                                placeholder="Texto do enigma (apenas para teste)"
                                class="btn-control btn-secondary"
                                style="
                                    flex: 2;
                                    min-width: 220px;
                                    text-align: left;
                                "
                            />
                            <button
                                class="btn-control btn-primary"
                                id="btnSimularEnigma"
                                type="button"
                            >
                                üì® Enviar
                            </button>
                        </div>
                        <p
                            style="
                                margin-top: 8px;
                                opacity: 0.8;
                                font-size: 12px;
                            "
                        >
                            Envia <code>responder_enigma</code> como o jogador
                            da vez. Use ‚úÖ/‚ùå para confirmar e validar a regra
                            de pista (C5 n√£o gera).
                        </p>
                    </div>
                </div>
            </aside>
        </div>

        <!-- Modal: All Tips Cards -->
        <div
            class="modal-overlay"
            id="modalCartas"
            role="dialog"
            aria-modal="true"
            aria-label="Cartas de dica"
        >
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title">üÉè Cartas de Dica</h3>
                    <button
                        class="modal-close"
                        id="btnCloseCartasModal"
                        type="button"
                        aria-label="Fechar"
                    >
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div id="cartasLista">
                        <!-- Cards will be listed here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button
                        class="btn-control btn-secondary"
                        id="btnFecharCartas"
                        type="button"
                    >
                        Fechar
                    </button>
                </div>
            </div>
        </div>

        <script src="../js/env.js"></script>
        <script src="../js/config.js"></script>
        <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
        <script src="../js/ui/feedback.js"></script>
        <script src="../js/mestre.js"></script>
    </body>
</html>
